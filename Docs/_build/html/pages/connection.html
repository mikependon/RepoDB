

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Connection &mdash; RepoDb 1.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hints" href="hints.html" />
    <link rel="prev" title="OrderField" href="orderfield.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> RepoDb
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="attributes.html">Attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="typemapping.html">Type Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="field.html">Field</a></li>
<li class="toctree-l1"><a class="reference internal" href="orderfield.html">OrderField</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Connection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#batchquery">BatchQuery</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bulkinsert">BulkInsert</a></li>
<li class="toctree-l2"><a class="reference internal" href="#count">Count</a></li>
<li class="toctree-l2"><a class="reference internal" href="#createcommand">CreateCommand</a></li>
<li class="toctree-l2"><a class="reference internal" href="#delete">Delete</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deleteall">DeleteAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ensureopen">EnsureOpen</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executenonquery">ExecuteNonQuery</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executequery">ExecuteQuery</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executequerymultiple">ExecuteQueryMultiple</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executereader">ExecuteReader</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executescalar">ExecuteScalar</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inlineinsert">InlineInsert</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inlinemerge">InlineMerge</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inlineupdate">InlineUpdate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#insert">Insert</a></li>
<li class="toctree-l2"><a class="reference internal" href="#merge">Merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="#query">Query</a></li>
<li class="toctree-l2"><a class="reference internal" href="#querymultiple">QueryMultiple</a></li>
<li class="toctree-l2"><a class="reference internal" href="#truncate">Truncate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update">Update</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hints.html">Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="transaction.html">Transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="querygroup.html">QueryGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="repository.html">Repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="persistency.html">Persistency</a></li>
<li class="toctree-l1"><a class="reference internal" href="cache.html">Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="trace.html">Trace</a></li>
<li class="toctree-l1"><a class="reference internal" href="statementbuilder.html">StatementBuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensibility.html">Extensibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Supported Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contacts</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">RepoDb</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Connection</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/pages/connection.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="connection">
<h1>Connection<a class="headerlink" href="#connection" title="Permalink to this headline">¶</a></h1>
<p>The library has abstracted everything from <cite>ADO.NET</cite> when it comes to the connection object.</p>
<div class="section" id="batchquery">
<h2>BatchQuery<a class="headerlink" href="#batchquery" title="Permalink to this headline">¶</a></h2>
<p>Queries a data from the database by batch.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="m">0</span><span class="p">,</span> <span class="m">24</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">24</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">),</span> <span class="m">0</span><span class="p">,</span> <span class="m">24</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="bulkinsert">
<h2>BulkInsert<a class="headerlink" href="#bulkinsert" title="Permalink to this headline">¶</a></h2>
<p>Bulk insert a list of data entity objects into the database.</p>
<p>Create a list to hold the data entities.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>
</pre></div>
</div>
<p>Add each item to be bulk-inserted.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="n">orders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
        <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span><span class="p">,</span>
        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">,</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Call the <cite>BulkInsert</cite> operation to insert the data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">orders</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The result would be the number of rows affected by the <cite>BulkInsert</cite> in the database.</p>
<p>This operation also support the <cite>DbDataReader</cite> object. However, by using this, the result would always be <cite>-1</cite>.</p>
<p>Initiate a <cite>DbDataReader</cite> object from the source connection.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">sourceConnection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind_Old;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">sourceConnection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;SELECT Quantity, ProductId, GETUTCDATE() AS CreatedDate, GETUTCDATE() AS UpdatedDate FROM [dbo].[Order];&quot;</span><span class="p">))</span>
        <span class="p">{</span>
                <span class="c1">// Do the stuffs here</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Call the <cite>BulkInsert</cite> operation by passing the <cite>DbDataReader</cite> object as the parameter.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">destinationConnection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Via entity type</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">reader</span><span class="p">);</span>

        <span class="c1">// Via table name</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="count">
<h2>Count<a class="headerlink" href="#count" title="Permalink to this headline">¶</a></h2>
<p>Counts the number of table data from the database.</p>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">noOfRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Count</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">noOfRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Count</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">field</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">noOfRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Count</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">field</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="createcommand">
<h2>CreateCommand<a class="headerlink" href="#createcommand" title="Permalink to this headline">¶</a></h2>
<p>Creates a command object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="c1">// Variables</span>
<span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;)</span><span class="k">null</span><span class="p">;</span>

<span class="c1">// Open a connection</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Create a command object</span>
        <span class="kt">var</span> <span class="n">command</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">CreateCommand</span><span class="p">(</span><span class="s">&quot;SELECT TOP 100 * FROM [dbo].[Customer];&quot;</span><span class="p">,</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="m">500</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>

        <span class="c1">// Use the command object here</span>
        <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="delete">
<h2>Delete<a class="headerlink" href="#delete" title="Permalink to this headline">¶</a></h2>
<p>Deletes an existing data from the database.</p>
<p>Via DataEntity:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="m">10045</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">customer</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Via PrimaryKey:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Deleting a data entity without a primary key will throw a <cite>PrimaryFieldNotFoundException</cite> exception.</p>
<p><strong>Note</strong>: By setting the <cite>where</cite> argument to blank would delete all the records. Exactly the same as <cite>DeleteAll</cite> operation.</p>
<p>Via Dynamic:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="deleteall">
<h2>DeleteAll<a class="headerlink" href="#deleteall" title="Permalink to this headline">¶</a></h2>
<p>Deletes all the data from the database.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">DeleteAll</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="ensureopen">
<h2>EnsureOpen<a class="headerlink" href="#ensureopen" title="Permalink to this headline">¶</a></h2>
<p>Ensures the connection object is open.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Use the connection here</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="executenonquery">
<h2>ExecuteNonQuery<a class="headerlink" href="#executenonquery" title="Permalink to this headline">¶</a></h2>
<p>Executes a query from the database. It uses the underlying method <cite>IDbCommand.ExecuteNonQuery</cite> and returns the number of affected rows during the execution.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;UPDATE O</span>
<span class="s">                SET O.Quantity = @Quantity</span>
<span class="s">                        , O.LastUpdatedUtc = @LastUpdatedUtc</span>
<span class="s">                FROM [dbo].[Order] O</span>
<span class="s">                WHERE (O.Id = @OrderId);&quot;</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">parameters</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">OrderId</span> <span class="p">=</span> <span class="m">1002</span><span class="p">,</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="n">parameters</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Let us say the stored procedure below exists.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">PROCEDURE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_update_order_quantity</span><span class="p">];</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_update_order_quantity</span><span class="p">]</span>
<span class="p">(</span>
        <span class="o">@</span><span class="n">OrderId</span> <span class="nb">INT</span>
        <span class="p">,</span> <span class="o">@</span><span class="n">Quantity</span> <span class="nb">INT</span>
<span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
        <span class="k">UPDATE</span> <span class="n">O</span>
        <span class="k">SET</span> <span class="n">O</span><span class="p">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">@</span><span class="n">Quantity</span>
                <span class="p">,</span> <span class="n">O</span><span class="p">.</span><span class="n">LastUpdatedUtc</span> <span class="o">=</span> <span class="n">GETUTCDATE</span><span class="p">()</span>
        <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="k">Order</span><span class="p">]</span> <span class="n">O</span>
        <span class="k">WHERE</span> <span class="p">(</span><span class="n">O</span><span class="p">.</span><span class="n">Id</span> <span class="o">=</span> <span class="o">@</span><span class="n">OrderId</span><span class="p">);</span>
<span class="k">END</span>
</pre></div>
</td></tr></table></div>
<p>Below is the code on how to execute a stored procedure mentioned above:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">parameters</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">OrderId</span> <span class="p">=</span> <span class="m">1002</span><span class="p">,</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_update_order_quantity]&quot;</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="executequery">
<h2>ExecuteQuery<a class="headerlink" href="#executequery" title="Permalink to this headline">¶</a></h2>
<p>Executes a query from the database. It uses the underlying method <cite>IDbCommand.ExecuteReader</cite> and converts the result back to an enumerable list of dynamic objects.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT * FROM [dbo].[Customer] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Let us say the stored procedure below exists.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">PROCEDURE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_customer</span><span class="p">];</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_customer</span><span class="p">]</span>
<span class="p">(</span>
        <span class="o">@</span><span class="n">CustomerId</span> <span class="nb">INT</span>
<span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
        <span class="k">SELECT</span> <span class="o">*</span>
        <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">Customer</span><span class="p">]</span> <span class="k">C</span>
        <span class="k">WHERE</span> <span class="p">(</span><span class="k">C</span><span class="p">.</span><span class="n">Id</span> <span class="o">=</span> <span class="o">@</span><span class="n">CustomerId</span><span class="p">);</span>
<span class="k">END</span>
</pre></div>
</td></tr></table></div>
<p>Below is the code on how to execute a stored procedure mentioned above:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_get_customer]&quot;</span><span class="p">,</span>
                <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span>
                <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An <cite>ExecuteQuery</cite> method can directly return an enumerable list of data entity object. No need to use the <cite>ExecuteReader</cite> method.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="s">&quot;SELECT * FROM [dbo].[Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The class property accessibility is very dynamic through this method. Let us say the order table schema is below.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">TABLE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="k">Order</span><span class="p">];</span>
<span class="k">GO</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="k">Order</span><span class="p">]</span>
<span class="p">(</span>
        <span class="n">Id</span> <span class="nb">INT</span>
        <span class="p">,</span> <span class="n">CustomerId</span> <span class="nb">INT</span>
        <span class="p">,</span> <span class="n">OrderDate</span> <span class="n">DATETIME2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
        <span class="p">,</span> <span class="n">Quantity</span> <span class="nb">INT</span>
        <span class="p">,</span> <span class="n">CreatedDate</span> <span class="n">DATETIME2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
        <span class="p">,</span> <span class="n">UpdatedDate</span> <span class="n">DATETIME2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">GO</span>
</pre></div>
</td></tr></table></div>
<p>No need for the class to have the exact match of the properties (also applicable in <cite>BatchQuery</cite> and <cite>Query</cite> operation).</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="na">[Map(&quot;[dbo]</span><span class="p">.[</span><span class="n">Order</span><span class="p">]</span><span class="s">&quot;)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">ComplexOrder</span>
<span class="p">{</span>
        <span class="c1">// Match properties</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">CustomerId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Quantity</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="n">DateTime</span> <span class="n">OrderDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">// Unmatch properties</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">ProductId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">OrderItemId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Price</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">double</span> <span class="n">Total</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">// Note: The CreatedDate and UpdatedDate is not defined on this class</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then call the records with the code below.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">ComplexOrder</span><span class="p">&gt;(</span><span class="s">&quot;SELECT * FROM [dbo].[Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Or, if a complex stored procedure is present.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">ComplexOrder</span><span class="p">&gt;(</span><span class="s">&quot;[dbo].[sp_name]&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <cite>ExecuteQuery</cite> method can also return a list of dynamic objects.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Did not passed the &lt;TEntity&gt;</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">(</span><span class="s">&quot;SELECT * FROM [dbo].[Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>

        <span class="c1">// Iterate the orders</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">order</span> <span class="k">in</span> <span class="n">orders</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="c1">// The &#39;order&#39; is dynamic</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Did not passed the &lt;TEntity&gt;</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_name]&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">);</span>

        <span class="c1">// Iterate the orders</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">order</span> <span class="k">in</span> <span class="n">orders</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="c1">// The &#39;order&#39; is dynamic</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note: Calling the <cite>ExecuteQuery</cite> via dynamic is a bit slower compared to CLR types.</p>
</div>
<div class="section" id="executequerymultiple">
<h2>ExecuteQueryMultiple<a class="headerlink" href="#executequerymultiple" title="Permalink to this headline">¶</a></h2>
<p>Executes a multiple query statement from the database and allows the user to extract the result to a target data entity.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT * FROM Customer WHERE Id = @CustomerId;</span>
<span class="s">                SELECT * FROM [Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">;</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQueryMultiple</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}))</span>
        <span class="p">{</span>
                <span class="c1">// Extract the first result</span>
                <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Extract</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>

                <span class="c1">// Extract the second result</span>
                <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Extract</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The method <cite>Scalar</cite> is used to extract the value of the first column of the first row of the <cite>DbDataReader</cite> object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT * FROM Customer WHERE Id = @CustomerId;</span>
<span class="s">                SELECT COUNT(*) FROM [Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">;</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQueryMultiple</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}))</span>
        <span class="p">{</span>
                <span class="c1">// Extract the first result</span>
                <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Extract</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>

                <span class="c1">// Extract the second result</span>
                <span class="kt">var</span> <span class="n">ordersCount</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">result</span><span class="p">.</span><span class="n">Scalar</span><span class="p">();</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This method can also be used to combine the calls with Stored Procedure.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_customer_orders</span><span class="p">]</span>
<span class="p">(</span>
        <span class="o">@</span><span class="n">CustomerId</span> <span class="nb">INT</span>
<span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
        <span class="k">SELECT</span> <span class="o">*</span>
        <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="k">Order</span><span class="p">]</span>
        <span class="k">WHERE</span> <span class="p">(</span><span class="n">CustomerId</span> <span class="o">=</span> <span class="o">@</span><span class="n">CustomerId</span><span class="p">);</span>
<span class="k">END</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT * FROM Customer WHERE Id = @CustomerId;</span>
<span class="s">                EXEC [dbo].[sp_get_customer_orders] @CustomerId;&quot;</span><span class="p">;</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQueryMultiple</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}))</span>
        <span class="p">{</span>
                <span class="c1">// Extract the first result</span>
                <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Extract</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>

                <span class="c1">// Extract the second result</span>
                <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Extract</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="executereader">
<h2>ExecuteReader<a class="headerlink" href="#executereader" title="Permalink to this headline">¶</a></h2>
<p>Executes a query from the database. It uses the underlying method <cite>IDbCommand.ExecuteReader</cite> and returns the instance of the data reader.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;SELECT * FROM [dbo].[Customer] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}))</span>
        <span class="p">{</span>
                <span class="c1">// Use the data reader here</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Let us say the stored procedure below exists.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">PROCEDURE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_customer</span><span class="p">];</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_customer</span><span class="p">]</span>
<span class="p">(</span>
        <span class="o">@</span><span class="n">CustomerId</span> <span class="nb">INT</span>
<span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
        <span class="k">SELECT</span> <span class="o">*</span>
        <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">Customer</span><span class="p">]</span> <span class="k">C</span>
        <span class="k">WHERE</span> <span class="p">(</span><span class="k">C</span><span class="p">.</span><span class="n">Id</span> <span class="o">=</span> <span class="o">@</span><span class="n">CustomerId</span><span class="p">);</span>
<span class="k">END</span>
</pre></div>
</td></tr></table></div>
<p>Below is the code on how to execute a stored procedure mentioned above:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_get_customer]&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">))</span>
        <span class="p">{</span>
                <span class="c1">// Use the data reader here</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="executescalar">
<h2>ExecuteScalar<a class="headerlink" href="#executescalar" title="Permalink to this headline">¶</a></h2>
<p>Executes a query from the database. It uses the underlying method <cite>IDbCommand.ExecuteScalar</cite> and returns the first occurence value (first column of first row) of the execution.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">maxId</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteScalar</span><span class="p">(</span><span class="s">&quot;SELECT MAX([Id]) AS MaxId FROM [dbo].[Customer];&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Let us say the stored procedure below exists.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">PROCEDURE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_latest_customer_id</span><span class="p">];</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_latest_customer_id</span><span class="p">]</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
        <span class="k">SELECT</span> <span class="k">MAX</span><span class="p">(</span><span class="n">Id</span><span class="p">)</span> <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">Customer</span><span class="p">];</span>
<span class="k">END</span>
</pre></div>
</td></tr></table></div>
<p>Below is the code on how to execute a stored procedure mentioned above:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">maxId</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteScalar</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_get_latest_customer_id]&quot;</span><span class="p">,</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="inlineinsert">
<h2>InlineInsert<a class="headerlink" href="#inlineinsert" title="Permalink to this headline">¶</a></h2>
<p>Inserts a new data in the database (certain fields only).</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Not really an order object, instead, it is a dynamic object</span>
        <span class="kt">var</span> <span class="n">entity</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
                <span class="n">ProductId</span> <span class="p">=</span> <span class="m">35</span><span class="p">,</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>

        <span class="c1">// Call the operation and define which object you are targetting</span>
        <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">InlineInsert</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">entity</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="inlinemerge">
<h2>InlineMerge<a class="headerlink" href="#inlinemerge" title="Permalink to this headline">¶</a></h2>
<p>Merges an object into an existing data in the database (certain fields only).</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Not really an order object, instead, it is a dynamic object</span>
        <span class="kt">var</span> <span class="n">entity</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Id</span> <span class="p">=</span> <span class="m">1002</span><span class="p">,</span>
                <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
                <span class="n">ProductId</span> <span class="p">=</span> <span class="m">35</span><span class="p">,</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>

        <span class="c1">// Call the operation and define which object you are targetting</span>
        <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">InlineMerge</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">entity</span><span class="p">,</span> <span class="k">new</span> <span class="p">[]</span>
        <span class="p">{</span>
                <span class="k">new</span> <span class="nf">Field</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">Id</span><span class="p">)),</span>
                <span class="k">new</span> <span class="nf">Field</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">))</span>
        <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the second parameter, the <cite>Field.From</cite> method can also be used.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">InlineMerge</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">entity</span><span class="p">,</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">)));</span>
</pre></div>
</div>
<p><strong>Note</strong>: The second parameter can be omitted if the data entity has a primary key.</p>
</div>
<div class="section" id="inlineupdate">
<h2>InlineUpdate<a class="headerlink" href="#inlineupdate" title="Permalink to this headline">¶</a></h2>
<p>Updates an existing data in the database (certain fields only).</p>
<p>Let us say a dynamic entity is defined.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="c1">// Not really a Customer object, instead, it is a dynamic object</span>
<span class="kt">var</span> <span class="n">entity</span> <span class="p">=</span> <span class="k">new</span>
<span class="p">{</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Anna Fullerton&quot;</span><span class="p">,</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Via PrimaryKey:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Call the operation and define which object you are targetting</span>
        <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">InlineUpdate</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">entity</span><span class="p">,</span> <span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Via Dynamic:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Call the operation and define which object you are targetting</span>
        <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">InlineUpdate</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">entity</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Call the operation and define which object you are targetting</span>
        <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">InlineUpdate</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">entity</span><span class="p">,</span> <span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Call the operation and define which object you are targetting</span>
        <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">InlineUpdate</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">entity</span><span class="p">,</span> <span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Customer</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="m">10045</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="insert">
<h2>Insert<a class="headerlink" href="#insert" title="Permalink to this headline">¶</a></h2>
<p>Inserts a new data in the database.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
        <span class="p">{</span>
                <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
                <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="merge">
<h2>Merge<a class="headerlink" href="#merge" title="Permalink to this headline">¶</a></h2>
<p>Merges a data entity object into an existing data in the database.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">1</span><span class="p">);</span>
        <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Field</span><span class="p">.</span><span class="n">Parse</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">Id</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the second parameter, the <cite>Field.From</cite> method can also be used.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Merge</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">entity</span><span class="p">,</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">Id</span><span class="p">)));</span>
</pre></div>
</div>
<p>Or, via a literal array of string.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Merge</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">entity</span><span class="p">,</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">));</span>
</pre></div>
</div>
<p><strong>Note</strong>: The second parameter can be omitted if the data entity has a primary key.</p>
</div>
<div class="section" id="query">
<h2>Query<a class="headerlink" href="#query" title="Permalink to this headline">¶</a></h2>
<p>Queries a data from the database.</p>
<p>Via PrimaryKey:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="m">10045</span><span class="p">).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Via Dynamic:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Customer</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="m">10045</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="querymultiple">
<h2>QueryMultiple<a class="headerlink" href="#querymultiple" title="Permalink to this headline">¶</a></h2>
<p>Query a multiple resultsets from the database.</p>
<p>Below is an example of how to query a customer where the <cite>Id</cite> field is equals to <cite>10045</cite>, and at the same time, querying all the orders connected to this customer since yesterday.
The result is an instance of a <cite>Tuple</cite> object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">fromDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">AddDays</span><span class="p">(-</span><span class="m">1</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">QueryMultiple</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">,</span> <span class="n">Order</span><span class="p">&gt;(</span>
                <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="n">customerId</span><span class="p">,</span>
                <span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="n">customerId</span> <span class="p">&amp;&amp;</span> <span class="n">o</span><span class="p">.</span><span class="n">CreatedDate</span> <span class="p">&gt;=</span> <span class="n">fromDate</span><span class="p">);</span>

        <span class="c1">// Read the customer</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item1</span><span class="p">.</span><span class="n">FirstOrDefault</span><span class="p">();</span>

        <span class="c1">// Read the orders</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item2</span><span class="p">.</span><span class="n">ToList</span><span class="p">();</span>
        <span class="n">orders</span><span class="p">.</span><span class="n">ForEach</span><span class="p">(</span><span class="n">order</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
                <span class="c1">// Do the stuffs for the &#39;order&#39; here</span>
        <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This method has supported until the last tupled dynamic type of the <cite>Tuple</cite> class. The current maximum tupled dynamic type is 7.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="n">DbConnection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">T3</span><span class="p">,</span> <span class="n">T4</span><span class="p">,</span> <span class="n">T5</span><span class="p">,</span> <span class="n">T6</span><span class="p">,</span> <span class="n">T7</span><span class="p">&gt;(</span>
        <span class="n">where1</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T1</span><span class="p">&gt;,</span>
        <span class="n">where2</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T2</span><span class="p">&gt;,</span>
        <span class="n">where3</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T3</span><span class="p">&gt;,</span>
        <span class="n">where4</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T4</span><span class="p">&gt;,</span>
        <span class="n">where5</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T5</span><span class="p">&gt;,</span>
        <span class="n">where6</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T6</span><span class="p">&gt;,</span>
        <span class="n">where7</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T7</span><span class="p">&gt;;</span>
</pre></div>
</div>
<p>Notice above, there were <cite>where&lt;T&lt;Num&gt;&gt;</cite> arguments. These arguments are targetting the specific index of the type on the ‘QueryMultiple’ operation. This method is not meant for joining the result of each type, but instead, it is used to execute the query execution at once.</p>
<p>Below is an example of how to query the list of customers based on different US states.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">QueryMultiple</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">&gt;(</span>
                <span class="n">where1</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;California&quot;</span><span class="p">,</span>
                <span class="n">where2</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Florida&quot;</span><span class="p">,</span>
                <span class="n">where3</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Texas&quot;</span><span class="p">,</span>
                <span class="n">where4</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Washington&quot;</span><span class="p">,</span>
                <span class="n">where5</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Michigan&quot;</span><span class="p">,</span>
                <span class="n">where6</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Arizona&quot;</span><span class="p">,</span>
                <span class="n">where7</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;New York&quot;</span><span class="p">);</span>

        <span class="c1">// Read the customers through its equivalent &#39;Item&lt;N&gt;&#39; property</span>
        <span class="kt">var</span> <span class="n">californiaCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item1</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">floridaCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item2</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">texasCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item3</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">washingtonCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item4</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">michiganCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item5</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">arizonaCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item6</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">newYorkCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item7</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Notice as well, there are other arguments defined like <cite>orderBy&lt;N&gt;</cite>, <cite>top&lt;N&gt;</cite> and <cite>hints&lt;N&gt;</cite>. These are the targetted arguments if the caller wants to define the behavior of the query for that target type based on the element-index provided.</p>
<p>Below is the implementation of the the 2 target types tupled.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="n">DbConnection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">&gt;(</span>
        <span class="n">where1</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T1</span><span class="p">&gt;,</span>
        <span class="n">where2</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T2</span><span class="p">&gt;,</span>
        <span class="n">orderBy1</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">OrderExpression</span> <span class="k">for</span> <span class="n">T1</span><span class="p">&gt;,</span>
        <span class="n">top1</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">RowFilter</span> <span class="k">for</span> <span class="n">T1</span><span class="p">&gt;,</span>
        <span class="n">hints1</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">QueryOptimizer</span> <span class="k">for</span> <span class="n">T1</span><span class="p">&gt;,</span>
        <span class="n">orderBy2</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">OrderExpression</span> <span class="k">for</span> <span class="n">T2</span><span class="p">&gt;,</span>
        <span class="n">top2</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">RowFilter</span> <span class="k">for</span> <span class="n">T2</span><span class="p">&gt;,</span>
        <span class="n">hints2</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">QueryOptimizer</span> <span class="k">for</span> <span class="n">T2</span><span class="p">&gt;);</span>
</pre></div>
</div>
<p>Below is a example of how to do a query that returns a 100 customers from <cite>California</cite> ordered by their <cite>SSID</cite> optimized by <cite>NOLOCK</cite> keyword, and also, a list of 1000 customers from <cite>Florida</cite> with <cite>READPAST</cite> query optimizer ordered by their <cite>LastName</cite> followed by <cite>FirstName</cite>.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">QueryMultiple</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">&gt;(</span>
                <span class="n">where1</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;California&quot;</span><span class="p">,</span>
                <span class="n">orderBy</span><span class="p">:</span> <span class="n">OrderField</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="k">new</span> <span class="p">{</span> <span class="n">SsId</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span> <span class="p">}),</span> <span class="cm">/* At RepoDb.Enumerations */</span>
                <span class="n">top1</span><span class="p">:</span> <span class="m">100</span><span class="p">,</span>
                <span class="n">hints1</span><span class="p">:</span> <span class="n">SqlTableHints</span><span class="p">.</span><span class="n">NoLock</span><span class="p">,</span> <span class="cm">/* Can write WITH (NOLOCK) */</span><span class="p">,</span>
                <span class="n">where2</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Florida&quot;</span><span class="p">,</span>
                <span class="n">orderBy2</span><span class="p">:</span> <span class="n">OrderField</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="k">new</span> <span class="p">{</span> <span class="n">LastName</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span><span class="p">,</span> <span class="n">FirstName</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span> <span class="p">}),</span> <span class="cm">/* At RepoDb.Enumerations */</span>
                <span class="n">top2</span><span class="p">:</span> <span class="m">1000</span><span class="p">,</span>
                <span class="n">hints2</span><span class="p">:</span> <span class="s">&quot;WITH (READPAST) /* Can use SqlTableHints.ReadPast */</span>
        <span class="p">);</span>

        <span class="c1">// Read the customers through its equivalent &#39;Item&lt;N&gt;&#39; property</span>
        <span class="kt">var</span> <span class="n">californiaCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item1</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">floridaCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Note</strong>: This method does not support the <cite>Object-Based</cite> query tree expression.</p>
</div>
<div class="section" id="truncate">
<h2>Truncate<a class="headerlink" href="#truncate" title="Permalink to this headline">¶</a></h2>
<p>Truncates a table from the database.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Truncate</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="update">
<h2>Update<a class="headerlink" href="#update" title="Permalink to this headline">¶</a></h2>
<p>Update an existing data in the database.</p>
<p>Let us say an <cite>Order</cite> object was queried from the database.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="c1">// Query a data from the database</span>
<span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">1002</span><span class="p">).</span><span class="n">FirstOrDefault</span><span class="p">();</span>

<span class="c1">// Set the target properties</span>
<span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
<span class="n">order</span><span class="p">.</span><span class="n">UpdateDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
</pre></div>
</div>
<p>Via DataEntity:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">order</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note: This call will throw an exception if the data entity does not have a primary key.</p>
<p>Via PrimaryKey:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">order</span><span class="p">,</span> <span class="m">1002</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Via Dynamic:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">order</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">1002</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">order</span><span class="p">,</span> <span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">1002</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="m">1002</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hints.html" class="btn btn-neutral float-right" title="Hints" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="orderfield.html" class="btn btn-neutral float-left" title="OrderField" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Michael Camara Pendon

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>